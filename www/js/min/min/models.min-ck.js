/* **********************************************
     Begin chrome.js
********************************************** *//* Chrome */nzp.ChromeView=Backbone.Model.extend({});nzp.Button=Backbone.Model.extend({});nzp.ContactPage=Backbone.Model.extend({});nzp.Header=Backbone.Model.extend({});nzp.HeaderTitle=Backbone.Model.extend({defaults:{title:""}});nzp.Place=Backbone.Model.extend({defaults:{apiKey:"a7f0c7b0b123012f06d2000c29b44ac0"},url:function(){return"http://api.nzpost.co.nz/locator/api/details?api_key=b2b736004873012e88a6442c03203548&id="+this.id+"&format=jsonp&callback=?&commit=Search"},getLatLng:function(){return new google.maps.LatLng(this.get("lat"),this.get("lng"))},createMarker:function(){switch(this.get("type")){case"PostShop":var e=new google.maps.MarkerImage("./img/sprite.locator.png",new google.maps.Size(24,36),new google.maps.Point(0,25),new google.maps.Point(10,34));break;case"Postbox":var e=new google.maps.MarkerImage("./img/sprite.locator.png",new google.maps.Size(24,36),new google.maps.Point(80,25),new google.maps.Point(10,34));break;case"Postbox Lobby":var e=new google.maps.MarkerImage("./img/sprite.locator.png",new google.maps.Size(24,36),new google.maps.Point(40,25),new google.maps.Point(10,34));break;default:var e=new google.maps.MarkerImage("./img/sprite.locator.png",new google.maps.Size(24,36),new google.maps.Point(0,25),new google.maps.Point(10,34))}var t=new google.maps.MarkerImage("./img/shadow.png",new google.maps.Size(40,37),new google.maps.Point(0,0),new google.maps.Point(12,35)),n=new google.maps.Marker({position:this.getLatLng(),title:this.get("name"),icon:e,location_type:this.get("type")});return n},infowindowContent:function(){var e=new Date,t=e.getDay();if(this.get("hours").length>0){var n=this.get("hours")[t-1];if(n.close!=undefined){var r=n.close,i=n.open,s=toDate(r,"h:m"),o=e.getHours(),u=e.getMinutes(),a=o+":"+u,f=toDate(a,"h:m");if(f>s)var l="Closed at "+r+" today";else var l="Open form "+i+" - "+r+" today"}else if(n.closed!=undefined)var l="Closed all day";else var l="Opening hours unknown"}else var l="";var c=this.get("id"),h=document.URL,p=h.indexOf("locator/"),d=h.substring(0,p+8),v=d+"closest/"+c,m=this.get("distance_in_m"),g=parseFloat(m/1e3).toFixed(2),y="",b=this.get("type"),w=this.get("address");y+='<div class="bubble">';b.length>0&&(y+="<h2>"+b+"</h2>");w.length>0&&(y+="<ul><li>"+w+"</li>");g.length>0&&(y+="<li>Distance: "+g+"km</li>");l.length>0&&(y+="<li>"+l+"</li>");y+='<li><a href="'+v+'">More info...</a></li></ul></div>';var E=y;return E}});nzp.Tab=Backbone.Model.extend({defaults:{highlighted:!1}});nzp.TrackingPage=Backbone.Model.extend({defaults:{apiKey:"b74c4cd0-b123-012f-7fbc-000c294e04ef",mockValue:1,highlight:"",user_added_name:"",short_description:"loading...",spinner:"list-spinner"},url:function(){return"http://api.nzpost.co.nz/tracking/track?license_key="+this.get("apiKey")+"&tracking_code="+this.get("track_code")+"&mock="+this.get("mockValue")+"&format=jsonp&callback=?"},parse:function(e){return this.isNew()?e:e[this.get("track_code")]},clear:function(){this.destroy()}});nzp.TrackingForm=nzp.TrackingPage.extend({});nzp.TrackingDescription=nzp.TrackingPage.extend({});nzp.Nav=Backbone.Model.extend({});nzp.HomePage=Backbone.Model.extend({});nzp.HomePage2=Backbone.Model.extend({url:"/data/navigationData.json"});nzp.LocatorPage=Backbone.Model.extend({defaults:{apiKey:"a7f0c7b0b123012f06d2000c29b44ac0",noResults:15},url:function(){return"http://api.nzpost.co.nz/locator/api/locations?api_key="+this.get("apiKey")+"&type=Postbox+Lobby&type=Dropbox&type=Postbox&type=PostShop&nearby_latitude="+this.get("lat")+"&nearby_longitude="+this.get("lng")+"&lat1=&lng1=&lat2=&lng2=&keyword=&max="+this.get("noResults")+"&format=jsonp&callback=?"},parse:function(e){var t={postshop:[],postbox:[],postboxlobby:[],postother:[],closestPlaces:[]};_.each(e,function(e){switch(e.type.toLowerCase()){case"postshop":t.postshop.push(e);break;case"postbox":t.postbox.push(e);break;case"postbox lobby":t.postboxlobby.push(e);break;default:t.postother.push(e)}},this);t.postshop&&t.postshop.length>0&&t.closestPlaces.push(t.postshop[0]);t.postbox&&t.postbox.length>0&&t.closestPlaces.push(t.postbox[0]);t.postboxlobby&&t.postboxlobby.length>0&&t.closestPlaces.push(t.postboxlobby[0]);t.postother&&t.postother.length>0&&t.closestPlaces.push(t.postother[0]);return t}});