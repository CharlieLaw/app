// Array of markers, requied to clear
var markers=[],ShowMapAllView=Backbone.View.extend({initialize:function(){_.bindAll(this,"render","allmarkers")},render:function(){typeof google=="undefined"?nzp.loadGoogleMap():nzp.initializeMap();myLocations={lat:this.collection.lat,lng:this.collection.lng};nzp.testMapLoaded(this.allmarkers,{lat:myLocations.lat,lng:myLocations.lng})},allmarkers:function(){nzp.infoWindow=new google.maps.InfoWindow;var e=new google.maps.LatLngBounds;this.collection.map(function(t){var n=t.toJSON(),r=t.getLatLng(),i=t.createMarker();i.setMap(map);e.extend(r);(function(e,t){google.maps.event.addListener(e,"click",function(n){nzp.infoWindow.setContent(t.infowindowContent());nzp.infoWindow.open(map,e)});markers.push(e)})(i,t)},this);map.fitBounds(e);var t=nzp.nearby_type||"All";nzp.calcMarkers(t);return this}});nzp.calcMarkers=function(e){$.each(markers,function(t,n){e.toLowerCase()===n.get("location_type").toLowerCase()||e==="All"?markers[t].setVisible(!0):markers[t].setVisible(!1)});nzp.headerTitle.set({title:e});nzp.router.navigate("locator/nearby/"+escape(e),{replace:!0})};